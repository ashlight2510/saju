<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>ê¶í•© Â· ì˜¤ëŠ˜ìš´ì„¸ Â· ì‹ ë…„ìš´ì„¸</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Adsense (ìš”ì²­ ë°˜ì˜) -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1204894220949193"
      crossorigin="anonymous"
    ></script>

    <style>
      body {
        margin: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont;
        background: #0b1621;
        color: #0f172a;
      }
      .wrap {
        max-width: 980px;
        margin: auto;
        padding: 24px;
      }
      h1,
      h2,
      h3 {
        margin: 0 0 10px;
      }
      .card {
        background: #fff;
        border-radius: 16px;
        padding: 18px;
        margin-bottom: 16px;
      }
      .lead {
        font-size: 1.1rem;
        font-weight: 700;
      }
      .mini {
        font-size: 0.85rem;
        color: #475569;
      }
      .btn {
        padding: 10px 14px;
        border-radius: 12px;
        border: none;
        font-weight: 700;
        cursor: pointer;
        background: #0f172a;
        color: #fff;
      }
      .btn.outline {
        background: #fff;
        color: #0f172a;
        border: 1px solid #0f172a;
      }
      .row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }
      .rule-card {
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 12px;
        margin-bottom: 10px;
      }
      .rule-head {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .like-btn {
        border: none;
        background: #e5e7eb;
        border-radius: 8px;
        padding: 4px 8px;
        cursor: pointer;
      }
      .radar {
        width: 100%;
        max-width: 420px;
        margin: auto;
        display: block;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <h1>ğŸ”® ê¶í•© ë¦¬í¬íŠ¸</h1>

      <!-- ì˜¤ëŠ˜ ìš´ì„¸ -->
      <div class="card">
        <h2>ì˜¤ëŠ˜ ìš´ì„¸ (ê¶í•© ê²°í•©)</h2>
        <p class="lead" id="todayCoupleLine">â€”</p>
        <p class="mini" id="todayCoupleMeta">â€”</p>
      </div>

      <!-- ì„¹ì…˜ ë ˆì´ë” -->
      <div class="card">
        <h2>ì„¹ì…˜ë³„ ê· í˜•</h2>
        <svg id="sectionRadarSvg" class="radar" viewBox="0 0 320 320"></svg>
      </div>

      <!-- íŠœë‹ UI -->
      <div class="card">
        <h2>íŠœë‹ (í•™ìŠµ ëŠë‚Œ)</h2>
        <div class="row">
          <span class="mini">ê°•ë„</span>
          <input
            type="range"
            min="0"
            max="2"
            step="0.1"
            value="1"
            id="tuneStrength"
          />
          <span id="tuneLabel">1.0</span>
          <button class="btn outline" id="tuneReset">ì´ˆê¸°í™”</button>
        </div>
        <p class="mini" id="tuneStatus"></p>
      </div>

      <!-- ê¶í•© ë£° -->
      <div class="card">
        <h2>ê¶í•© í¬ì¸íŠ¸</h2>
        <div id="ruleList"></div>
      </div>

      <!-- ì‹ ë…„ìš´ì„¸ -->
      <div class="card">
        <h2>2026 ì‹ ë…„ìš´ì„¸ (ì›”ë³„)</h2>
        <div id="monthlyList"></div>
      </div>

      <!-- ê³µìœ  -->
      <div class="card">
        <h2>ê³µìœ </h2>
        <button class="btn" id="shareBtn">ê³µìœ  ì¹´ë“œ ë§Œë“¤ê¸°</button>
        <canvas
          id="shareCanvas"
          width="1080"
          height="1350"
          style="display: none"
        ></canvas>
      </div>
    </div>

    <script>
      /* ======================================================
  0. ìƒ˜í”Œ ë°ì´í„° (A/B ì‚¬ì£¼ ê²°ê³¼ë¼ê³  ê°€ì •)
====================================================== */
      const A = {
        name: "A",
        elements: { ëª©: 0.9, í™”: 1.4, í† : 1.0, ê¸ˆ: 0.6, ìˆ˜: 1.8 },
        topElem: "ìˆ˜",
        dayBranch: "ì",
      };
      const B = {
        name: "B",
        elements: { ëª©: 1.2, í™”: 1.1, í† : 1.1, ê¸ˆ: 0.9, ìˆ˜: 1.3 },
        topElem: "ìˆ˜",
        dayBranch: "ì¶•",
      };

      /* ======================================================
  1. ì˜¤ëŠ˜ ìš´ì„¸ â†” ê¶í•©
====================================================== */
      function todayAdvantage(A, B) {
        const key = "ìˆ˜"; // ì˜¤ëŠ˜ í•µì‹¬ ì˜¤í–‰ ì˜ˆì‹œ
        const a = A.elements[key],
          b = B.elements[key];
        if (a - b > 0.3)
          return {
            line: "ì˜¤ëŠ˜ì€ Aê°€ ìœ ë¦¬í•´. ì¤‘ìš”í•œ ì–˜ê¸°ëŠ” Aê°€ ë¨¼ì €.",
            meta: `A ${a} / B ${b}`,
          };
        if (b - a > 0.3)
          return {
            line: "ì˜¤ëŠ˜ì€ Bê°€ ìœ ë¦¬í•´. ê²°ì •ì€ B ìª½ ì»¨ë””ì…˜ì— ë§ì¶°.",
            meta: `A ${a} / B ${b}`,
          };
        return {
          line: "ì˜¤ëŠ˜ì€ ê· í˜•ì ì¸ ë‚ . í˜‘ì˜í•˜ë©´ ì˜ í’€ë ¤.",
          meta: `A ${a} / B ${b}`,
        };
      }
      function renderTodayCoupleBox(A, B) {
        const t = todayAdvantage(A, B);
        todayCoupleLine.textContent = t.line;
        todayCoupleMeta.textContent = t.meta;
      }

      /* ======================================================
  2. ì„¹ì…˜ ì ìˆ˜ + ë ˆì´ë”
====================================================== */
      function calcSectionScores() {
        return { ì„±í–¥: 82, ê´€ê³„: 76, ëˆ: 68, ì¼: 85, ê±´ê°•: 72 };
      }
      function renderRadar(scores) {
        const svg = sectionRadarSvg;
        const keys = ["ì„±í–¥", "ê´€ê³„", "ëˆ", "ì¼", "ê±´ê°•"];
        const cx = 160,
          cy = 160,
          R = 110;
        svg.innerHTML = "";
        const ang = (i) => ((Math.PI * 2) / 5) * i - Math.PI / 2;
        const pt = (v, i) => [
          cx + R * v * Math.cos(ang(i)),
          cy + R * v * Math.sin(ang(i)),
        ];
        const p = keys
          .map((k, i) => pt(scores[k] / 100, i).join(","))
          .join(" ");
        svg.innerHTML += `<polygon points="${p}" fill="rgba(59,130,246,.3)" stroke="#2563eb" stroke-width="2"/>`;
      }

      /* ======================================================
  3. ë£° + íŠœë‹
====================================================== */
      const RULES = [
        { id: "L1", text: "ì˜¤í–‰ ìˆ˜(æ°´)ê°€ ë‘˜ ë‹¤ ê°•í•´ì„œ ê¸°ë³¸ ê²°ì´ ë§ì•„." },
        { id: "L2", text: "ì¼ì§€ í•©ì´ ì„±ë¦½ë¼ ìƒí™œ ë¦¬ë“¬ì´ í¸í•´." },
      ];
      const TUNE_KEY = "tune";
      function loadTune() {
        return JSON.parse(localStorage.getItem(TUNE_KEY) || "{}");
      }
      function saveTune(v) {
        localStorage.setItem(TUNE_KEY, JSON.stringify(v));
      }
      function feedback(id) {
        const t = loadTune();
        t[id] = (t[id] || 0) + 1;
        saveTune(t);
        renderTune();
      }
      function renderTune() {
        const t = loadTune();
        tuneStatus.textContent = `íŠœë‹ ë£° ${Object.keys(t).length}ê°œ ë°˜ì˜ ì¤‘`;
      }
      function renderRules() {
        ruleList.innerHTML = RULES.map(
          (r) => `
    <div class="rule-card">
      <div class="rule-head">
        <b>${r.id}</b>
        <button class="like-btn" onclick="feedback('${r.id}')">ê³µê°</button>
      </div>
      <p>${r.text}</p>
    </div>`
        ).join("");
      }

      /* ======================================================
  4. ì‹ ë…„ìš´ì„¸ ì›”ë³„
====================================================== */
      function makeMonthlyLuck() {
        return Array.from({ length: 12 }, (_, i) => ({
          m: i + 1,
          s: `${i + 1}ì›”ì€ íë¦„ì´ ë¬´ë‚œí•´.`,
          t: `ì¤‘ìš”í•œ ì¼ 1ê°œë§Œ ì§‘ì¤‘.`,
        }));
      }
      function renderMonthly() {
        monthlyList.innerHTML = makeMonthlyLuck()
          .map(
            (m) => `
    <div class="rule-card">
      <b>${m.m}ì›”</b>
      <p>${m.s}</p>
      <p class="mini">íŒ: ${m.t}</p>
    </div>`
          )
          .join("");
      }

      /* ======================================================
  5. ê³µìœ  ì¹´ë“œ
====================================================== */
      function shareCard() {
        const c = shareCanvas,
          ctx = c.getContext("2d");
        ctx.fillStyle = "#0f172a";
        ctx.fillRect(0, 0, c.width, c.height);
        ctx.fillStyle = "#fff";
        ctx.font = "bold 48px sans-serif";
        ctx.fillText("ê¶í•© ë¦¬í¬íŠ¸", 80, 120);
        ctx.font = "32px sans-serif";
        ctx.fillText(todayCoupleLine.textContent, 80, 220);
        c.toBlob((b) => {
          const a = document.createElement("a");
          a.href = URL.createObjectURL(b);
          a.download = "ê¶í•©.png";
          a.click();
        });
      }

      /* ======================================================
  INIT
====================================================== */
      renderTodayCoupleBox(A, B);
      renderRadar(calcSectionScores());
      renderRules();
      renderMonthly();
      renderTune();

      shareBtn.onclick = shareCard;
      tuneStrength.oninput = (e) => (tuneLabel.textContent = e.target.value);
      tuneReset.onclick = () => {
        localStorage.removeItem(TUNE_KEY);
        renderTune();
      };
    </script>
  </body>
</html>
